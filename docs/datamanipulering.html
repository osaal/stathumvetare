<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="“Människovetaren och statistiken” är en grundkurs i den statistiska analysens process, ämnad för universitetsstuderande i samhälls- och humanvetenskaper. Målet är att göra statistisk analys tillgänglig och begriplig, och att minska studentens statistikångest genom att synliggöra hur statistik egentligen är likt all annan forskning, fastän med siffror. Boken är en work-in-progress, med början den 12:e februari 2023.">

<title>Människovetaren och statistiken - 10&nbsp; Datamanipulering</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./grafik.html" rel="next">
<link href="./r-del-två.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Datamanipulering</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Människovetaren och statistiken</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Förord</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Analysens logik</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vad-är-statistik.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Vad är statistik?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vad-är-data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Vad är data?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./från-ide-till-rapport.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Från idé till rapport</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./variabler.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Variabler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modeller.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modeller</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistisk-inferens.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Statistisk inferens</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">R-miljön</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduktion-till-r-miljön.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Introduktion till R-miljön</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./grundläggande-kunskaper-i-programmering.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Grundläggande kunskaper i R-programmering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-del-två.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">R, del två</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datamanipulering.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Datamanipulering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./grafik.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Grafik</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Statistiska metoder</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./univariat-analys.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Univariat analys</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bivariat-analys.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Bivariat analys</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regressionsanalys.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Regressionsanalys</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./källförteckning.html" class="sidebar-item-text sidebar-link">Källförteckning</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#faktorer" id="toc-faktorer" class="nav-link active" data-scroll-target="#faktorer"><span class="toc-section-number">10.1</span>  Faktorer</a>
  <ul class="collapse">
  <li><a href="#omvandla-sifferkodade-faktorer-till-textkodade-faktorer" id="toc-omvandla-sifferkodade-faktorer-till-textkodade-faktorer" class="nav-link" data-scroll-target="#omvandla-sifferkodade-faktorer-till-textkodade-faktorer"><span class="toc-section-number">10.1.1</span>  Omvandla sifferkodade faktorer till textkodade faktorer</a></li>
  </ul></li>
  <li><a href="#breda-och-långa-tabeller" id="toc-breda-och-långa-tabeller" class="nav-link" data-scroll-target="#breda-och-långa-tabeller"><span class="toc-section-number">10.2</span>  Breda och långa tabeller</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Datamanipulering</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
</div>
<p>Från namnet kunde man tro att “datamanipulering” handlar om någon slags senmodern förtrycksmetod, men så är inte fallet. Datamanipulering handlar helt enkelt om att omforma, kombinera, separera och kategorisera data. Manipulation är nästan alltid nödvändigt - de flesta data finns inte i sådana former som vi skulle vilja, och ibland måste vi även manipulera data för att korrigera modellförväntningsbrott.</p>
<p>I detta kapitel behandlar jag några funktioner för datamanipulation. Alla manipulationer som kan göras på enskilda siffror (t.ex. multiplikation eller logaritmering) kan förstås också göras på strukturerade data i en tibble eller dataram. För strukturerade data finns det dock några ytterligare behändiga manipulationsmetoder, som gör arbetet mycket lättare.</p>
<section id="faktorer" class="level2 page-columns page-full" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="faktorer"><span class="header-section-number">10.1</span> Faktorer</h2>
<p>I kapitel XXX behandlade jag statistiska variablers skalenivåer. Detta är ett så grundläggande koncept att R har inbyggda metoder angående skalenivåer. Datatypen <code>factor</code>, alltså faktor, är en sådan.</p>
<p>Faktordata är data på nominal- eller ordinalskalenivå. Istället för att representera det i siffror kan R automatiskt förstå en variabel med några unika värden som en kvalitativ variabel. Tänk dig att du hade följande data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>personregister <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"Person"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Jimmy"</span>,<span class="st">"Claus"</span>,<span class="st">"Susan"</span>,<span class="st">"Freja"</span>,<span class="st">"Timotej"</span>),</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Kön"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Man"</span>,<span class="st">"Man"</span>,<span class="st">"Kvinna"</span>,<span class="st">"Annat"</span>,<span class="st">"Man"</span>),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Inkomst"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">25000</span>,<span class="dv">0</span>,<span class="dv">35000</span>,<span class="dv">30000</span>,<span class="dv">15000</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                         )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-datamanip-1" class="anchored">
<table class="table table-sm table-striped">
<caption>Table&nbsp;10.1: Personregister</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Person</th>
<th style="text-align: left;">Kön</th>
<th style="text-align: right;">Inkomst</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Jimmy</td>
<td style="text-align: left;">Man</td>
<td style="text-align: right;">25000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Claus</td>
<td style="text-align: left;">Man</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Susan</td>
<td style="text-align: left;">Kvinna</td>
<td style="text-align: right;">35000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Freja</td>
<td style="text-align: left;">Annat</td>
<td style="text-align: right;">30000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Timotej</td>
<td style="text-align: left;">Man</td>
<td style="text-align: right;">15000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Variabeln <code>Person</code> fungerar i detta fall som en ID-variabel (eftersom varje namn är unikt), men kan också förstås som en nominalvariabel där de allra flesta värden kommer att vara unika. Förvisso kan det finnas flera personer med namnet “Jimmy”, kanske även “Timotej”, men för det mesta är dessa värden unika. Detta innebär att vi inte troligen vill göra mycket något med denna variabel. Dessutom representeras ju varje rad av en unik person, så summering enligt <code>Person</code> är inte så rimligt - vad betyder det att “Timotejer” har i medeltal 15 000 euro inkomst?</p>
<p>Variabeln <code>Kön</code> representerar däremot en klassisk nominalvariabel. Det finns bara tre värden i vårt dataset, och vissa upprepas. Denna vill vi omvandla till en faktor, så att R vet att hantera variabeln som kategorisk!</p>
<p>Variabeln <code>Inkomst</code> är tydligen på kvotskalenivå, eftersom den tycks representera euro (i året, om dessa personer inte är väldigt rika eller väldigt fattiga på en nordisk nivå). Då vill vi inte göra något åt denna variabel - den går att behandla som sådan i R-analyser.</p>
<p>Hur berättar vi åt R att <code>Kön</code> ska vara kategorisk? Med funktionen <code>factor(data)</code>. Funktionen tar de data vi ger den, räknar unika värden, och markerar dessa som kategorier inom variabeln. Detta omvandlar variabeln till en speciell faktorvariabel, som går att använda i kvantitativa analyser (så länge kategoriska data är OK i modellen!). Vi utför detta i R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>personregister<span class="sc">$</span>Kön <span class="ot">&lt;-</span> <span class="fu">factor</span>(personregister<span class="sc">$</span>Kön)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>personregister</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  Person  Kön    Inkomst
  &lt;chr&gt;   &lt;fct&gt;    &lt;dbl&gt;
1 Jimmy   Man      25000
2 Claus   Man          0
3 Susan   Kvinna   35000
4 Freja   Annat    30000
5 Timotej Man      15000</code></pre>
</div>
</div>
<p>Inga förändringar skedde till själva datapunkterna, och detta är vad som borde ske. Däremot har <em>datatypen</em> för <code>Kön</code> ändrat från <code>character</code> till <code>factor</code> - och detta möjliggör att den används i kategoriska analyser! Du kan se detta genom att granska kolumnnamnen i tibbleobjektet ovan.</p>
<p>Kan <code>factor(data)</code> beakta nivåernas ordning, om det är fråga om ordinalskalenivå? Jovisst! Låt oss säga att vi har en ny variabel, som mäter <code>ångest</code>:</p>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-datamanip-2" class="anchored">
<table class="table table-sm table-striped">
<caption>Table&nbsp;10.2: Personregister med nya data</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Person</th>
<th style="text-align: left;">Kön</th>
<th style="text-align: right;">Inkomst</th>
<th style="text-align: left;">Ångest</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Jimmy</td>
<td style="text-align: left;">Man</td>
<td style="text-align: right;">25000</td>
<td style="text-align: left;">Låg</td>
</tr>
<tr class="even">
<td style="text-align: left;">Claus</td>
<td style="text-align: left;">Man</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Hög</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Susan</td>
<td style="text-align: left;">Kvinna</td>
<td style="text-align: right;">35000</td>
<td style="text-align: left;">Hög</td>
</tr>
<tr class="even">
<td style="text-align: left;">Freja</td>
<td style="text-align: left;">Annat</td>
<td style="text-align: right;">30000</td>
<td style="text-align: left;">Medel</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Timotej</td>
<td style="text-align: left;">Man</td>
<td style="text-align: right;">15000</td>
<td style="text-align: left;">Låg</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>För att skapa en ordinalfaktor använder vi funktionen <code>ordered(data, levels=x)</code>. Vi ger funktionen vårt data, <code>personregister$Ångest</code>, samt en vektor med alla variabelnivåer i ordning från högsta/största till lägsta/minsta. Egentligen kan vi även använda <code>factor()</code>-funktionen med tilläggsargumentet <code>ordered = TRUE</code>, men sättet jag gjorde det här är i min åsikt tydligare. Du gör förstås hur du vill.</p>
<p>Som tidigare nämnt producerar detta ingen tydlig visuell skillnad - <em>de facto</em> var ångestvariabeln i <a href="#tbl-datamanip-2">Table&nbsp;<span>10.2</span></a> redan ordnad före jag berättade om ordningsfunktionen! Däremot har det en påverkan i vissa metoder, om de använder nominal- eller ordinalskalevariabler. Det är därför bra kutym att spara kvalitativa variabler som sådana, inte kvantitativa, även om det till synes inte gör något åt materialet.</p>
<section id="omvandla-sifferkodade-faktorer-till-textkodade-faktorer" class="level3 page-columns page-full" data-number="10.1.1">
<h3 data-number="10.1.1" class="anchored" data-anchor-id="omvandla-sifferkodade-faktorer-till-textkodade-faktorer"><span class="header-section-number">10.1.1</span> Omvandla sifferkodade faktorer till textkodade faktorer</h3>
<p>Om du kommer från ett annat statistikprogram har du kanske blivit van att spara kvalitativa variabler i sifferformat, med explicita kodböcker som berättar vilken siffra står för vilken kategori. Du skulle i såfall kanske ha velat koda <code>Kön</code> med siffrorna 1, 2 och 3, och sedan associerat siffrorna med etiketterna “Man”, “Kvinna” och “Annat”.</p>
<p>I R är det bättre att använda de inbyggda faktor- och ordinalfaktordatatyperna, eftersom de förhindrar att du utför opasslig analys på datamaterialet. Om du sparar faktorer som siffror kan du i misstag analysera dem t.ex. med vanliga regressionsmetoder, även om detta bryter mot regressionsanalysens grundläggande krav (variablerna måste vara kvantitativa för regression).</p>
<div class="page-columns page-full"><p>Om du dessutom har färdiga siffror i ditt datamaterial istället för textfaktorer kan det vara lockande att hålla kvar siffrorna. Du kan dock väldigt lätt omvandla kategorier med funktionen <code>case_match()</code> från paketet <code>dplyr</code>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;En tidigare funktion som vissa läsare kan vara bekanta med, <code>recode()</code> ska vid skrivande stund avskrivas, så jag rekommenderar inte användningen av den.</p></li></div></div>
<p>Att omvandla från faktor till siffror (om du verkligen vill det) är väldigt lätt: <code>case_match(datakolumn, kategori_1 ~ siffra, kategori_2 ~ siffra, ...)</code>. Lista alltså bara upp varje faktorkategori och ge den en siffra.</p>
<p>Omvandlande från siffror till faktor är lite svårare. För det måste vi först köra <code>case_match(datakolumn, siffra_1 ~ kategori, siffra_2 ~ kategori, ...)</code> och sedan omvandla den resulterande textvektorn till en faktor:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Omvandla texten i "Kön" till siffror:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>personregister<span class="sc">$</span>Kön <span class="ot">&lt;-</span> <span class="fu">case_match</span>(personregister<span class="sc">$</span>Kön, <span class="st">"Man"</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="st">"Kvinna"</span> <span class="sc">~</span> <span class="dv">2</span>, <span class="st">"Annat"</span> <span class="sc">~</span> <span class="dv">3</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Omvandla siffrorna i "Kön" tillbaka till text:</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># OBS: Märk att siffrorna bör vara omringade av citattecken!</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>personregister<span class="sc">$</span>Kön <span class="ot">&lt;-</span> <span class="fu">case_match</span>(personregister<span class="sc">$</span>Kön, <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Man"</span>, <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Kvinna"</span>, <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Annat"</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Annat"</span>, <span class="st">"Kvinna"</span>, <span class="st">"Man"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="breda-och-långa-tabeller" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="breda-och-långa-tabeller"><span class="header-section-number">10.2</span> Breda och långa tabeller</h2>
<p>Ett annat viktigt koncept i</p>


</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./r-del-två.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">R, del två</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./grafik.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Grafik</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>